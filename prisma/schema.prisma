// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Event {
  id        Int          @id @default(autoincrement())
  is_over    Boolean      @default(false)
  sensors   SensorsOnEvents[]
  created_at DateTime     @default(now())
  vehicles  VehiclesOnEvents[]
  @@map("events")
}

model Sensor {
  id        Int          @id @default(autoincrement())
  intensity Int
  latitude  Float
  longitude Float
  events    SensorsOnEvents[]
  created_at DateTime     @default(now())
  @@map("sensors")
}

model Vehicle {
  id        Int          @id @default(autoincrement())
  is_busy Boolean     @default(false)
  latitude  Float
  longitude Float
  created_at DateTime     @default(now())
  events    VehiclesOnEvents[]
  Type TypeVehicle @relation(fields: [type_vehicle_id], references: [id])
  type_vehicle_id Int
  @@map("vehicles")
}

model TypeVehicle {
  id        Int          @id @default(autoincrement())
  name     String
  capacity Int
  vehicles Vehicle[]
  @@map("type_vehicles")
}

model Base {
  id        Int          @id @default(autoincrement())
  name     String
  latitude  Float
  longitude Float
  created_at DateTime     @default(now())
  @@map("bases")
}

model SensorsOnEvents {
  event    Event    @relation(fields: [event_id], references: [id])
  event_id  Int      // relation scalar field (used in the `@relation` attribute above)
  sensor   Sensor   @relation(fields: [sensor_id], references: [id])
  sensor_id Int      // relation scalar field (used in the `@relation` attribute above)
  created_at DateTime @default(now())
  @@map("pivot_events_sensors")
  @@id([event_id, sensor_id])
}

model VehiclesOnEvents {
  event    Event    @relation(fields: [event_id], references: [id])
  event_id  Int      // relation scalar field (used in the `@relation` attribute above)
  vehicle   Vehicle   @relation(fields: [vehicle_id], references: [id])
  vehicle_id Int      // relation scalar field (used in the `@relation` attribute above)
  created_at DateTime @default(now())
  @@map("pivot_events_vehicles")
  @@id([event_id, vehicle_id])
}

